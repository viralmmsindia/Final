<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üåê Viral Videshi Leak Videos üåê</title>
    <style>
        /* Basic styling for the page */
        body {
            background-color: #000; /* Black background */
            font-family: Arial, sans-serif; /* Standard font */
            color: white; /* White text */
            margin: 0; /* Remove default margin */
            padding: 16px; /* Add some padding around the content */
        }

        /* Header styling */
        header {
            text-align: center; /* Center align the header text */
            font-size: 6vw; /* Responsive font size based on viewport width */
            font-family: 'Impact', sans-serif; /* Impact font for header */
            color: cyan; /* Cyan color for the main header text */
            text-shadow: 0 0 10px cyan; /* Add a cyan glow effect */
            margin-bottom: 15px; /* Space below the header */
        }

        /* Styling for the emojis/spans within the header */
        header span {
            color: #fff; /* White color for the surrounding spans */
            text-shadow: 0 0 15px #fff; /* Add a white glow effect */
        }

         /* Adjust spacing around header spans */
        header span:first-child { margin-right: 0.1em; }
        header span:last-child { margin-left: 0.1em; }

        /* Search bar styling */
        .search-bar {
            display: block; /* Make it a block element to control width/margin */
            width: calc(100% - 32px); /* Full width minus padding */
            padding: 12px; /* Padding inside the search bar */
            margin: 0 auto 15px auto; /* Center horizontally, add margin below */
            border-radius: 8px; /* Rounded corners */
            border: none; /* No border */
            font-size: 16px; /* Font size */
            box-sizing: border-box; /* Include padding in the element's total width */
            max-width: 600px; /* Limit maximum width on larger screens */
        }

        /* Container for the video gallery */
        #gallery {
            padding: 0 16px; /* Padding on the sides */
        }

        /* Individual video card styling */
        .video-card {
            background-color: #111; /* Dark background for cards */
            border-radius: 12px; /* Rounded corners */
            padding: 16px; /* Padding inside the card */
            margin: 14px 0; /* Margin above and below each card */
            box-shadow: 0 0 10px #333; /* Subtle shadow effect */
        }

        /* Iframe (video player) styling */
        iframe {
            width: 100%; /* Full width of the card */
            height: 52vw; /* Responsive height based on viewport width */
            max-height: 300px; /* Maximum height */
            border-radius: 8px; /* Rounded corners */
            overflow: hidden; /* Hide anything outside the border radius */
            border: none; /* Remove default iframe border */
        }

        /* Styling for buttons container */
        .buttons {
            margin-top: 10px; /* Space above the buttons */
        }

        /* Styling for links styled as buttons */
        .buttons a {
            display: inline-block; /* Allow setting margin/padding */
            margin: 6px 4px 0; /* Margin around buttons */
            padding: 8px 12px; /* Padding inside buttons */
            border-radius: 8px; /* Rounded corners */
            color: black; /* Text color */
            text-decoration: none; /* Remove underline */
            font-size: 14px; /* Font size */
            transition: background-color 0.2s ease; /* Smooth background transition on hover */
            cursor: pointer; /* Pointer cursor on hover */
        }

        /* Specific styling for the main watch button */
        .watch-btn {
            background: cyan; /* Cyan background */
            color: black; /* Black text */
        }
         .watch-btn:hover {
            background: #88ffff; /* Lighter cyan on hover */
         }

        /* Specific styling for alternate link buttons */
        .alt-btn {
            background: #fff; /* White background */
             color: black; /* Black text */
        }
         .alt-btn:hover {
            background: #eee; /* Light gray on hover */
         }

        /* Styling for the adblock warning message */
        #adblock-warning {
            display: none; /* Hidden by default */
            background: red; /* Red background */
            color: white; /* White text */
            padding: 10px; /* Padding */
            text-align: center; /* Centered text */
            font-weight: bold; /* Bold text */
            margin: 20px 16px; /* Margin */
            border-radius: 8px; /* Rounded corners */
        }

        /* Styling for the categories section */
        #categories-container {
            text-align: center; /* Center the content */
            margin-bottom: 20px; /* Space below the categories */
            padding: 0 16px; /* Side padding */
            display: flex; /* Use flex to center the inner container */
            flex-direction: column; /* Stack label and list vertically */
            align-items: center; /* Center items horizontally */
        }

        /* Styling for the scrollable list container holding category buttons */
        #categories {
            display: block; /* Change from flex to block */
            max-height: ; /* Limit the height */
            overflow-y: auto; /* Enable vertical scrolling */
            margin-top: 8px; /* Space above the list */
            border: 1px solid #09d8be; /* Optional: add a border */
            border-radius: 8px; /* Optional: rounded corners for the list */
            padding: 5px; /* Padding inside the scrollable area */
            width: 100%; /* Set a width */
            max-width: px; /* Set a max-width */
            box-sizing: border-box; /* Include padding/border in width */
        }

        /* Styling for individual category buttons */
        #categories button {
            display: block; /* Make each button take full width */
            width: 100%; /* Make button fill container width */
            background: none; /* No background */
            border: 1px solid yellow; /* Yellow border */
            color: yellow; /* Yellow text */
            margin: 0 0 5px 0; /* Bottom margin for spacing, remove others */
            padding: 8px 12px; /* Padding inside the button */
            cursor: pointer; /* Pointer cursor */
            text-shadow: 0 0 5px yellow; /* Yellow glow effect */
            font-weight: bold; /* Bold text */
            border-radius: 15px; /* Pill-shaped buttons */
            transition: background-color 0.2s ease, color 0.2s ease; /* Smooth transition */
            box-sizing: border-box; /* Include padding/border in width */
            text-align: center; /* Center text within button */
        }
        /* Remove margin from last button */
        #categories button:last-child {
            margin-bottom: 0;
        }


        /* Hover effect for category buttons */
        #categories button:hover {
            background-color: yellow; /* Yellow background on hover */
            color: black; /* Black text on hover */
        }

        /* Styling for the "Categories" label */
        #categories-container b {
             color: white; /* White text */
             text-shadow: 0 0 5px yellow; /* Yellow glow */
             display: block; /* Make it a block */
             margin-bottom: 5px; /* Space below the label */
             width: 100%; /* Ensure it spans width for centering */
        }

        /* Custom scrollbar styling (optional, WebKit browsers) */
        #categories::-webkit-scrollbar {
            width: 8px;
        }
        #categories::-webkit-scrollbar-track {
            background: #222;
            border-radius: 4px;
        }
        #categories::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 4px;
        }
        #categories::-webkit-scrollbar-thumb:hover {
            background: #777;
        }


    </style>
</head>
<body>
    <header><span>üåê</span> Viral Videshi Leak Videos <span>üåê</span></header>

    <input class="search-bar" type="text" id="search" placeholder="Search by Tag or Title..." />

    <div id="categories-container">
        <b>Categories</b>
        <div id="categories">
            </div>
    </div>

    <div id="gallery">
        <p style="text-align: center; margin-top: 20px;">Loading videos...</p>
    </div>

    <div id="adblock-warning">Ad Blocker Detected! Please disable your ad blocker to continue using this site.</div>

    <script>
        // !!
        // IMPORTANT SECURITY WARNING !!
        // EXPOSING YOUR GOOGLE SHEETS API KEY DIRECTLY IN CLIENT-SIDE CODE
        // IS NOT SECURE. ANYONE CAN VIEW SOURCE AND STEAL YOUR KEY.
        // FOR A PRODUCTION APP, USE A BACKEND SERVER (LIKE NODE.JS, PYTHON FLASK/DJANGO, ETC.)
        // TO ACT AS A PROXY TO FETCH DATA FROM GOOGLE SHEETS SECURELY.
        // PROCEED WITH CAUTION IF USING THIS CLIENT-SIDE METHOD FOR TESTING/PERSONAL USE ONLY.
        // --- UPDATE THESE CONSTANTS FOR YOUR DATA SOURCE ---
        const sheetID = '1rd3bCc2mzWt1boJ190ynD_4PZMdUutYrAE0k5O6knj8'; // <<-- REPLACE with your Google Sheet ID
        const apiKey = 'AIzaSyAfuYJHxubZ_v5AGToEcKPd4P_PifgDMCo';   // <<-- REPLACE with your Google Sheets API Key
        const range = 'Sheet1!A:J';           // <<-- REPLACE with your Sheet Name and Range (e.g., 'Sheet1!A:J' to get columns A to J)
                                              // Assumes: Col A: Category, Col B: Title, Col C: Embed URL,
                                              // Col D: Alt1, Col E: Alt2, Col F: Alt3, Col G: Tag,
                                              // Col H: Description, Col I: Views, Col J: Date
        const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${range}?key=${apiKey}`;

        // --- Global Variables ---
        let allVideos = []; // Array to store all video data fetched from the sheet
        let allCategories = []; // Array to store unique categories from the sheet
        let currentSearchTerm = ''; // Stores the current filter/search term

        // --- DOM Element References ---
        const galleryContainer = document.getElementById("gallery");
        const searchInput = document.getElementById('search');
        const adblockWarning = document.getElementById('adblock-warning');
        const categoriesContainer = document.getElementById('categories'); // Reference to the scrollable div

        // --- Data Fetching Function ---
        async function fetchVideos() {
            galleryContainer.innerHTML = '<p style="text-align: center; margin-top: 20px;">Fetching data from Google Sheet...</p>'; // Initial loading message
            console.log("Attempting to fetch data from:", url); // Log the URL being fetched
            try {
                const res = await fetch(url); // Fetch data from the Google Sheets API URL
                if (!res.ok) {
                    // Handle HTTP errors (e.g., 404 Not Found, 403 Forbidden - check API key/permissions)
                    const errorBody = await res.text();
                    console.error(`HTTP error! status: ${res.status}`, errorBody); // Log the actual error response body
                    galleryContainer.innerHTML = `<p style="text-align: center; margin-top: 20px; color: red;">Error loading videos (Status: ${res.status}). Check API Key, Sheet ID, Range, and Sheet Permissions (must be public/viewable). See console for details.</p>`;
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                const data = await res.json(); // Parse the JSON response
                const rows = data.values; // Get the array of rows

                // *** DEBUGGING: Log raw data received from API ***
                console.log('Raw rows data received:', rows);

                // Check if data exists and has more than just a header row
                if (!rows || rows.length < 2) {
                    console.warn("No data rows found in Google Sheet response (expected header + data). Check sheet content and range.");
                    galleryContainer.innerHTML = '<p style="text-align: center; margin-top: 20px;">No video data found in the sheet. Ensure sheet is not empty and range is correct.</p>';
                    // Still try to render categories container in case header was fetched but no data rows
                    extractAndRenderCategories([]); // Render empty categories
                    return []; // Return empty array if no valid data rows
                }

                const fetchedCategories = new Set(); // Use a Set to automatically handle unique categories
                const videoData = []; // Array to store processed video objects

                // Iterate through rows, starting from the second row (index 1) to skip the header
                console.log(`Processing ${rows.length - 1} data rows...`);
                for (let i = 1; i < rows.length; i++) {
                    const row = rows[i];
                    // *** DEBUGGING: Log the category value being read from Column A ***
                    console.log(`Row ${i + 1}: Raw category value (Column A): '${row ? row[0] : 'ROW UNDEFINED'}'`);

                    // Ensure row exists and has enough columns before accessing them
                    if (row && row.length > 0) { // Check if row exists and has at least one column (for category)
                         const category = row[0] ? String(row[0]).trim() : ''; // Get category from Column A (index 0), ensure it's a string, trim whitespace
                         if (category) {
                             fetchedCategories.add(category); // Add unique category to the Set
                             console.log(`Row ${i + 1}: Added category: '${category}'`); // Log added category
                         } else {
                              console.log(`Row ${i + 1}: No category found or Column A is empty.`);
                         }

                         // Create a video object from the row data, only if embed link exists
                         // Check if embed link (Column C, index 2) exists
                         if (row.length > 2 && row[2]) {
                             videoData.push({
                                 category: category,     // Store category
                                 title: row[1] || '',    // Column B
                                 embed: row[2] || '',    // Column C
                                 alt1: row[3] || '',     // Column D
                                 alt2: row[4] || '',     // Column E
                                 alt3: row[5] || '',     // Column F
                                 tag: row[6] || '',      // Column G - Crucial for category filtering
                                 desc: row[7] || '',     // Column H
                                 views: row[8] || '0',   // Column I
                                 date: row[9] || ''      // Column J
                             });
                         } else {
                              console.warn(`Skipping row ${i + 1}: Missing embed link in Column C.`);
                         }
                    } else {
                        console.warn(`Skipping row ${i + 1}: Row is empty or undefined.`);
                    }
                }

                allCategories = [...fetchedCategories].sort(); // Convert Set to Array and sort alphabetically
                allVideos = videoData; // Store all valid videos (already filtered for embed link)

                // *** DEBUGGING: Log the final processed categories ***
                console.log('Final processed categories:', allCategories);
                console.log(`Finished processing. Found ${allVideos.length} videos with embed links and ${allCategories.length} unique categories.`);

                return allVideos; // Return the processed videos

            } catch (error) {
                // Handle network errors or other issues during fetch/processing
                console.error("Error in fetchVideos function:", error);
                // Display error only if no specific error message is already shown
                if (!galleryContainer.innerHTML.includes('Error loading videos') && !galleryContainer.innerHTML.includes('No video data found')) {
                    galleryContainer.innerHTML = '<p style="text-align: center; margin-top: 20px; color: red;">Failed to load videos. Check Network connection, Sheet Permissions, API Key, and browser console for errors.</p>';
                }
                 extractAndRenderCategories([]); // Ensure categories section shows 'No categories found' on error
                return []; // Return empty array on error
            }
        }

        // --- Rendering Functions ---

        /**
         * Renders the video cards into the gallery container.
         * @param {Array} data - An array of video objects to render.
         */
        function renderVideos(data) {
            // Handle case where no videos match the filter/search OR initial load failed
            if (data.length === 0) {
                // Check if an error message or 'no data' message is already displayed
                const galleryHasMessage = galleryContainer.innerHTML.includes('Error loading videos') ||
                                         galleryContainer.innerHTML.includes('No video data found');
                if (!galleryHasMessage) {
                     galleryContainer.innerHTML = '<p style="text-align: center; margin-top: 20px;">No videos found matching your criteria.</p>';
                }
                return;
            }

            // Generate HTML for each video card and join them together
            galleryContainer.innerHTML = data.map(video => `
                <div class="video-card" data-category="${video.category || ''}" data-tag="${video.tag || ''}">
                    <h3>${video.title || 'No Title Provided'}</h3>
                    ${video.embed ?
                        // Use sandbox attribute for slightly better security with embeds
                        `<iframe src="${video.embed}" frameborder="0" allowfullscreen scrolling="no" sandbox="allow-scripts allow-same-origin"></iframe>` :
                        '<p style="color:#fdd;">Embed link missing or invalid.</p>'
                    }
                    <p><strong>Category:</strong> ${video.category || 'N/A'}</p>
                    <p><strong>Tags:</strong> ${video.tag || 'N/A'}</p>
                    <p><strong>Description:</strong> ${video.desc || 'No description available.'}</p>
                    <p><strong>Views:</strong> ${video.views}</p>
                    <div class="buttons">
                        ${video.embed ? `<a href="${video.embed}" class="watch-btn" target="_blank" rel="noopener noreferrer">Watch Now</a>` : ''}
                        ${video.alt1 ? `<a href="${video.alt1}" class="alt-btn" target="_blank" rel="noopener noreferrer">Alternate 1</a>` : ''}
                        ${video.alt2 ? `<a href="${video.alt2}" class="alt-btn" target="_blank" rel="noopener noreferrer">Alternate 2</a>` : ''}
                        ${video.alt3 ? `<a href="${video.alt3}" class="alt-btn" target="_blank" rel="noopener noreferrer">Alternate 3</a>` : ''}
                    </div>
                </div>
            `).join('');
        }

        /**
         * Creates and renders the category filter buttons inside the #categories div.
         * @param {Array} categories - An array of unique category strings.
         */
        function extractAndRenderCategories(categories) {
            // Target the #categories div specifically for button rendering
            const buttonsListContainer = document.getElementById('categories');

            if (!categories || categories.length === 0) { // Check if categories array is valid and not empty
                console.log("No categories found to render."); // Log this specific case
                buttonsListContainer.innerHTML = '<p style="font-size: 0.9em; color: #aaa; text-align: center;">No categories found.</p>'; // Display message inside the list container
                return;
            }
            // Generate a button for each category
            console.log("Rendering category buttons:", categories);
            buttonsListContainer.innerHTML = categories.map(category => {
                 // Basic sanitization: replace single quotes in category names to avoid breaking the onclick attribute
                 const sanitizedCategory = category.replace(/'/g, "\\'");
                 // Ensure category name itself is properly escaped for HTML display
                 const escapedCategory = category.replace(/</g, "&lt;").replace(/>/g, "&gt;");
                 return `<button onclick="filterByCategory('${sanitizedCategory}')">${escapedCategory}</button>`;
                }
            ).join('');
        }


        /**
         * Filters videos when a category button is clicked.
         * Exposed to global scope (window) to be callable from inline onclick handler.
         * @param {string} category - The category name to filter by.
         */
        window.filterByCategory = function(category) {
            console.log("Filtering by category:", category);
            searchInput.value = category; // Update search bar to show the category
            currentSearchTerm = category.toLowerCase(); // Set the search term for filtering
            applyFiltersAndRender(); // Apply the filter and re-render
        };

        // --- Filtering Logic ---

        /**
         * Filters the `allVideos` array based on `currentSearchTerm` and re-renders the gallery.
         * Search matches against video tags OR titles (case-insensitive).
         */
        function applyFiltersAndRender() {
            let videosToRender = allVideos; // Start with all videos

            if (currentSearchTerm) { // Apply filter only if there's a search term
                const searchTermLower = currentSearchTerm.toLowerCase();
                 console.log("Applying filter/search term:", searchTermLower);
                videosToRender = videosToRender.filter(video =>
                    // Check if the tag includes the search term OR the title includes the search term
                    (video.tag && video.tag.toLowerCase().includes(searchTermLower)) ||
                    (video.title && video.title.toLowerCase().includes(searchTermLower))
                );
            } else {
                 console.log("No search term, showing all videos.");
            }

            console.log(`Rendering ${videosToRender.length} videos after filtering.`);
            renderVideos(videosToRender); // Render the filtered (or unfiltered) list
        }

        // --- UI Event Listeners ---

        // Update filter as user types in the search bar
        searchInput.addEventListener('input', function (e) {
            currentSearchTerm = e.target.value.toLowerCase(); // Get current search value
            applyFiltersAndRender(); // Apply filter and re-render
        });

        // --- Adblock Detection (Basic) ---
        function checkAdblock() {
            // Only run check if videos loaded successfully (avoid false positives on error pages)
             const galleryHasError = galleryContainer.innerHTML.includes('Error loading videos') ||
                                    galleryContainer.innerHTML.includes('No video data found');
            if (!galleryHasError && allVideos.length > 0) { // Also check if videos were actually loaded
                // Create a dummy element with a class often targeted by adblockers
                const adTest = document.createElement('div');
                adTest.className = 'adsbox'; // Common class name blocked by adblockers
                // Make it invisible and non-interactive
                adTest.style.cssText = 'position: absolute; top: -1px; left: 0; width: 1px; height: 1px; visibility: hidden; pointer-events: none;';
                document.body.appendChild(adTest);

                // Check its properties after a short delay (allow adblocker to potentially hide it)
                setTimeout(() => {
                    try { // Add try...finally to ensure removal
                        if (document.body.contains(adTest) && // Check if still in DOM
                           (!adTest.offsetHeight || adTest.style.display === 'none' || adTest.style.visibility === 'hidden')) {
                            // If the element is hidden or has no height, assume adblocker is active
                            console.warn("Adblocker detected.");
                            adblockWarning.style.display = 'block'; // Show the warning message
                        }
                    } finally {
                         if (document.body.contains(adTest)) {
                            adTest.remove(); // Clean up the dummy element
                         }
                    }
                }, 150); // Increased delay slightly
            } else {
                console.log("Skipping adblock check due to loading error or no videos.");
            }
        }

        // --- Initial Page Load Function ---
        async function loadContent() {
            console.log("DOMContentLoaded event fired. Starting loadContent...");
            await fetchVideos(); // Fetch videos and populate allVideos and allCategories
            // fetchVideos now calls extractAndRenderCategories on error/no data, so we only call it here if successful
            // Render categories even if no videos found, as long as categories exist OR if fetch failed (to show 'no categories')
            extractAndRenderCategories(allCategories); // Create and display category buttons (or 'no categories' message)

            renderVideos(allVideos); // Render the initial list of videos (might be empty if fetch failed)
            checkAdblock(); // Perform the adblock check after content is potentially loaded
            console.log("loadContent finished.");
        }

        // --- Run on Page Load ---
        // Use DOMContentLoaded to ensure the HTML structure is ready before running scripts
        window.addEventListener('DOMContentLoaded', loadContent);

    </script>
</body>
</html>
