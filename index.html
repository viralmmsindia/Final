<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‚ÄºÔ∏è Viral Indian Leak MMS ‚ÄºÔ∏è</title>
    <style>
        body {
            background-color: #000;
            font-family: Arial, sans-serif;
            color: white;
            margin: 0;
            padding: 0;
            padding-top: 16px;
        }

        header {
            text-align: center;
            font-size: 6vw;
            font-family: 'Impact', sans-serif;
            color: yellow;
            text-shadow: 0 0 10px yellow;
            margin-bottom: 15px;
            padding: 0 16px;
        }

        header span {
            color: red;
            text-shadow: 0 0 15px red;
        }

        .search-bar {
            display: block;
            width: calc(100% - 32px);
            padding: 12px;
            margin: 0 16px 15px 16px;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            box-sizing: border-box;
        }

        #gallery {
            padding: 0 16px;
        }

        .video-card {
            background-color: #111;
            border-radius: 12px;
            padding: 16px;
            margin: 14px 0;
            box-shadow: 0 0 10px #333;
        }

        iframe {
            width: 100%;
            height: 52vw;
            max-height: 300px;
            border-radius: 8px;
            overflow: hidden;
        }

        .buttons a {
            display: inline-block;
            margin: 6px 4px 0;
            padding: 8px 12px;
            border-radius: 8px;
            color: white;
            text-decoration: none;
            font-size: 14px;
            transition: background-color 0.2s ease;
        }

        .watch-btn {
            background: yellow;
            color: black;
        }
         .watch-btn:hover {
            background: #ffff66;
         }

        .alt-btn {
            background: orange;
        }
         .alt-btn:hover {
            background: #ffb347;
         }

        #adblock-warning {
            display: none;
            background: red;
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            margin: 20px 16px;
            border-radius: 8px;
        }

        /* --- Bilingual Disclaimer Modal --- */
        #entryModal {
            position: fixed;
            z-index: 9999;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        #entryModal > div {
            background: #111;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
         #entryModal h2 {
            color: yellow;
            text-shadow: 0 0 10px red;
         }
         #entryModal p {
            color: #ccc;
            margin-bottom: 20px;
         }
         #entryModal button {
            padding: 10px 20px;
            margin: 10px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            border: none;
            transition: transform 0.2s ease;
         }
         #entryModal button:hover {
            transform: scale(1.05);
         }

         #entryModal button:first-of-type {
             background: orange;
             color: black;
             box-shadow: 0 0 10px orange;
         }
         #entryModal button:last-of-type {
             background: cyan;
             color: black;
             box-shadow: 0 0 10px cyan;
         }
    </style>
</head>
<body>
    <header><span>‚ÄºÔ∏è</span> Viral Indian Leak MMS <span>‚ÄºÔ∏è</span></header>

    <input class="search-bar" type="text" id="search" placeholder="Search by tags..." style="margin-bottom: 15px;" />

    <div id="gallery"></div>
    <div id="adblock-warning">Ad Blocker Detected! Please disable your ad blocker to continue using this site.</div>

    <div id="entryModal">
        <div>
            <h2>‚ö†Ô∏è Adult Content Ahead / ‡§µ‡§Ø‡§∏‡•ç‡§ï ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä</h2>
            <p>This site contains NSFW content. Please confirm your preference to continue.<br/>‡§Ø‡§π ‡§∏‡§æ‡§á‡§ü ‡§µ‡§Ø‡§∏‡•ç‡§ï ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§∞‡§ñ‡§§‡•Ä ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ö‡§Ø‡§® ‡§ï‡§∞‡•á‡§Ç‡•§</p>
            <div style="margin-top: 20px;">
                <button id="desiBtn">üáÆüá≥ Desi Videos / ‡§¶‡•á‡§∏‡•Ä ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã</button>
                <button id="videshiBtn">üåê Videshi Videos / ‡§µ‡§ø‡§¶‡•á‡§∂‡•Ä ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã</button>
            </div>
        </div>
    </div>


    <script>
        // !! IMPORTANT SECURITY WARNING !!
        // EXPOSING YOUR GOOGLE SHEETS API KEY DIRECTLY IN CLIENT-SIDE CODE
        // IS NOT SECURE. ANYONE CAN SEE AND MISUSE IT.
        // FOR A PRODUCTION APP, YOU SHOULD USE A BACKEND SERVER
        // TO FETCH DATA FROM GOOGLE SHEETS.
        // PROCEED WITH CAUTION IF USING THIS METHOD.

        // --- Configuration ---
        const sheetID = '1tMby5ZNJU9Ymx5XBJhHqL67DOVIpc_n2lnGqsk_JPCg'; // <<-- REPLACE WITH YOUR ACTUAL GOOGLE SHEET ID
        const apiKey = 'AIzaSyAfuYJHxubZ_v5AGToEcKPd4P_PifgDMCo'; // <<-- REPLACE WITH YOUR ACTUAL GOOGLE API KEY
        const range = 'Viralmms'; // <<-- REPLACE WITH YOUR SHEET NAME IF DIFFERENT (e.g., 'VideosData')
        const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${range}?key=${apiKey}`;

        // --- Global Variables ---
        let allVideos = []; // Stores all fetched videos
        let currentSearchTerm = ''; // Stores the current search input

        // --- DOM Elements ---
        const galleryContainer = document.getElementById("gallery");
        const searchInput = document.getElementById('search');
        const adblockWarning = document.getElementById('adblock-warning');
        const entryModal = document.getElementById('entryModal');
        // Get references to the modal buttons
        const desiButton = document.getElementById('desiBtn');
        const videshiButton = document.getElementById('videshiBtn');


        // --- Data Fetching ---
        async function fetchVideos() {
            try {
                const res = await fetch(url);
                if (!res.ok) {
                    const errorBody = await res.text();
                    console.error(`HTTP error! status: ${res.status}`, errorBody);
                    galleryContainer.innerHTML = '<p style="text-align: center; margin-top: 20px; color: red;">Error loading videos. Please check console for details.</p>';
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                const data = await res.json();
                const rows = data.values;
                if (!rows || rows.length < 2) {
                    console.warn("No data or only header found in Google Sheet.");
                    galleryContainer.innerHTML = '<p style="text-align: center; margin-top: 20px;">No videos found in the sheet.</p>';
                    return [];
                }
                rows.shift(); // Remove header row

                 // Map data to objects, providing default empty strings if column is missing
                 // Reverse the array here to display the first sheet entry last
                return rows.map(row => {
                    return {
                        title: row[1] || '', // Column B (index 1) for Title
                        embed: row[2] || '', // Column C (index 2) for Embed URL - THIS IS WHERE YOU PUT THE LINK
                        alt1: row[3] || '', // Column D (index 3) for Alt 1
                        alt2: row[4] || '', // Column E (index 4) for Alt 2
                        alt3: row[5] || '', // Column F (index 5) for Alt 3
                        tag: row[6] || '', // Column G (index 6) for Tag (Categories)
                        desc: row[7] || '', // Column H (index 7) for Description
                        views: row[8] || '0', // Column I (index 8) for Views
                        date: row[9] || '2000-01-01' // Column J (index 9) for Date
                    };
                }).reverse(); // <--- Added .reverse() here to reverse the order
            } catch (error) {
                console.error("Error fetching videos:", error);
                 if (!galleryContainer.innerHTML.includes('Error loading videos')) {
                     galleryContainer.innerHTML = '<p style="text-align: center; margin-top: 20px; color: red;">Failed to load videos. Check your API Key and Sheet ID.</p>';
                 }
                return [];
            }
        }

        // --- Rendering ---
        function renderVideos(data) {
             if (data.length === 0) {
                galleryContainer.innerHTML = '<p style="text-align: center; margin-top: 20px;">No videos found matching your criteria.</p>';
                return;
            }
            galleryContainer.innerHTML = data.map(video => `
                <div class="video-card">
                    <h3>${video.title || 'No Title'}</h3>
                    ${video.embed ? `<iframe src="${video.embed}" frameborder="0" allowfullscreen scrolling="no" sandbox="allow-scripts allow-same-origin"></iframe>` : '<p style="color:#f00;">Embed link missing or invalid.</p>'}
                    <p><strong>Tags:</strong> ${video.tag || 'N/A'}</p>
                    <p><strong>Description:</strong> ${video.desc || 'No description available.'}</p>
                    <p><strong>Views:</strong> ${video.views}</p>
                    <div class="buttons">
                        ${video.embed ? `<a href="${video.embed}" class="watch-btn" target="_blank">Watch Now</a>` : ''}
                        ${video.alt1 ? `<a href="${video.alt1}" class="alt-btn" target="_blank">Alternate 1</a>` : ''}
                        ${video.alt2 ? `<a href="${video.alt2}" class="alt-btn" target="_blank">Alternate 2</a>` : ''}
                        ${video.alt3 ? `<a href="${video.alt3}" class="alt-btn" target="_blank">Alternate 3</a>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // --- Filtering Logic ---
        function applyFiltersAndRender() {
            let videosToRender = allVideos;

            // Filter by Search Term (applied to title, description, and tags)
            if (currentSearchTerm) {
                const searchTermLower = currentSearchTerm.toLowerCase();
                videosToRender = videosToRender.filter(video =>
                    video.title.toLowerCase().includes(searchTermLower) ||
                    video.desc.toLowerCase().includes(searchTermLower) ||
                    video.tag.toLowerCase().includes(searchTermLower) // Search tags directly
                 );
            }

            renderVideos(videosToRender);
            // Removed category highlighting logic
        }


        // --- UI Interactions ---

        // Function to load content after modal is dismissed
        async function loadContent() {
             allVideos = await fetchVideos(); // Fetch videos and store them (now reversed)
             // Removed extractAndRenderCategories
             applyFiltersAndRender(); // Initially render all videos (in reversed order)
             checkAdblock(); // Check for adblocker after content load attempt
        }

        // Age/Content Disclaimer Modal Handler
        function handleModalSelection(choice) {
            if (choice === 'desi') {
                entryModal.style.display = 'none';
                 loadContent(); // Call the function to load videos and render
            } else if (choice === 'videshi') {
                 window.open("https://videshi.example.com", "_blank");
            }
        }

        // Removed Categories Panel Open/Close listeners

        // Removed Category Item Click listener

        // Search Input
        searchInput.addEventListener('input', function (e) {
            currentSearchTerm = e.target.value.toLowerCase(); // Update search term
            applyFiltersAndRender(); // Apply filters and render
        });
        // Adblock Detection (run after content is loaded)
        function checkAdblock() {
            const adTest = document.createElement('div');
            adTest.className = 'adsbox'; // Common class name targeted by adblockers
            adTest.style.cssText = 'position: absolute; top: -1px; left: 0; width: 1px; height: 1px; visibility: hidden; pointer-events: none;'; // Hide visually
            document.body.appendChild(adTest);
            setTimeout(() => {
                 // Check if the element was blocked (height 0, display: none, etc.)
                if (!adTest.offsetHeight || adTest.style.display === 'none' || adTest.style.visibility === 'hidden') {
                    adblockWarning.style.display = 'block';
                }
                adTest.remove();
            }, 100); // Give adblocker a moment to act
        }

        // --- Initial Page Setup ---
        window.addEventListener('DOMContentLoaded', () => {
             if (desiButton) {
                 desiButton.addEventListener('click', () => {
                     handleModalSelection('desi');
                 });
             }

             if (videshiButton) {
                 videshiButton.addEventListener('click', () => {
                     handleModalSelection('videshi');
                 });
             }
        });
    </script>
</body>
</html>