
<!DOCTYPE html>
<html>
<head>
  <title>Video Embedder</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .video-wrapper {
      position: relative;
      padding-bottom: 56.25%; /* 16:9 ratio */
      height: 0;
      overflow: hidden;
      margin-bottom: 20px;
    }
    .video-wrapper iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <h1>Embedded Videos from Google Sheets</h1>
  <div id="video-container"></div>

  <script>
    const sheetId = '1tMby5ZNJU9Ymx5XBJhHqL67DOVIpc_n2lnGqsk_JPCg';
    const apiKey = 'AIzaSyAfuYJHxubZ_v5AGToEcKPd4P_PifgDMCo';
    const range = 'Sheet1';  // Make sure this matches your actual sheet name

    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`)
      .then(response => response.json())
      .then(data => {
        const container = document.getElementById('video-container');
        const rows = data.values;
        if (!rows) return;

        rows.forEach(row => {
          const videoUrl = row[0];
          if (videoUrl) {
            const wrapper = document.createElement('div');
            wrapper.className = 'video-wrapper';

            const iframe = document.createElement('iframe');
            iframe.src = videoUrl;
            iframe.frameBorder = "0";
            iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
            iframe.allowFullscreen = true;

            wrapper.appendChild(iframe);
            container.appendChild(wrapper);
          }
        });
      })
      .catch(error => console.error('Error fetching data:', error));
  </script>
</body>
</html>
